# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Introduction

  
#### Creator Skill Level

 Intermediate  
#### Recommended Prerequisite Background Knowledge

 Some TypeScript experience is recommended as well as access to the desktop
editor, and VS Code.  
#### Description

 Learn how to create, store, and manage JSON Objects as Player Persistent
Variables (PPVs) in Meta Horizon, including versioning for updates and expansions.
Given Meta Horizon’s 10kb data limit for PPVs, we’ll show you how to evaluate and
optimize your JSON Object’s size. This knowledge enables the storage of hundreds of variables in a single JSON
PPV, facilitating the creation of experiences that remember visitor progress and
allow seamless continuation. Additionally, it supports the growth of player data
in future updates without the need for new JSON PPVs.  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Introduction
...
#### Learning Objectives

 By reading and reviewing this written guide you will be able to:
• Create and store JSON Objects as Player Persistent Variables
• Add versioning to JSON PPVs: allows for updating and adding new variables
• Check the variable’s max size

  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 1: Create a JSON PPV

 Once the world is loaded, click the systems drop-down and select “Persistent
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 1: Create a JSON PPV
...
Variables.” ![Screenshot 2024-03-12 165250.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452885043_512509794620310_1164532069211912730_n.png?_nc_cat=108&ccb=1-7&_nc_sid=e280be&_nc_ohc=r00UDhGzsyQQ7kNvwF3wfCr&_nc_oc=AdlglSaGC6-RFu6j3YEzSbX8X5hum0oDESwSkGo1kt54KdJjatIlVWtnaQ_buksuC6w&_nc_zt=14&_nc_ht=scontent-dfw5-3.xx&_nc_gid=qAmEIbIl1jtgn...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 1: Create a JSON PPV
...
 Click the plus icon to create a variable. In this example, we will name it “TestVar” making sure to select “{ } Object”
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 1: Create a JSON PPV
...
from the drop-down. ![Screenshot 2024-03-12 165344.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452652041_512509847953638_1230264767479043441_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=Vs_wtxUOo1EQ7kNvwFpGIy8&_nc_oc=AdnNQtdr6yYARW9Bg7a0poRfDkj-qRfkWZhywyXkdJPOPtV9_oxuV29XokLSXUsIEOY&_nc_zt=14&_nc_ht=scontent-d...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 1: Create a JSON PPV
...
 Now that JSON Object PPV has been created, it can be used in TypeScript scripts
by referencing it using the string name it was given: “TestVar.”  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 2: Create Scripts
...
### Specified Script Names:


• PlayerVar_Defs
• PlayerVar_Manager

  
### Mentor’s Note

 Defs and _Manager are two of several naming conventions I use in my scripts to
help organize and plan my code. There are no right or wrong approaches, so feel
free to adopt one that works well for you. _Defs store type declarations, classes, and enums. _Manager handles logic and typically has a Component that attaches to a single
object in the world. Other naming conventions I use include, _Data, _Entity, and _Func.  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 2: Create Scripts
...
### Script Setup

 As of the current Meta Horizon desktop build (March 2024), creating a new world
requires the initial creation of a 1.0 script prior to switching the script mode
to 2.0. Once the switch is made, the 1.0 script can be deleted. Access to this feature is found under the script tab: select the gear icon,
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 2: Create Scripts
...
### Script Setup
...
followed by Script Settings to view the API Version drop-down: ![Image](https://scontent-dfw5-1.xx.fbcdn.net/v/t39.2365-6/452690902_512509841286972_4120111531248974789_n.png?_nc_cat=101&ccb=1-7&_nc_sid=e280be&_nc_ohc=W3B3iD77eYwQ7kNvwFUfHEj&_nc_oc=AdnEt5smqBNvudK0HopsNA1G6WRdaFUbZCl_AmZc_at8HYK8H2qMDrVQxjqUKBR4aPo&_nc_zt=14&_nc_ht=scontent-dfw5-1.xx&_nc_gid=qAmEIbIl...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 2: Create Scripts

 To begin, we will create two scripts with the specified names seen below. It’s
important to verify that Meta Horizon’s 2.0 API is selected by accessing the
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 2: Create Scripts
...
settings via the gear icon. ![Screenshot 2024-03-12 165632.png](https://scontent-dfw5-1.xx.fbcdn.net/v/t39.2365-6/452915617_512509827953640_3795839271183190167_n.png?_nc_cat=103&ccb=1-7&_nc_sid=e280be&_nc_ohc=8U7JK3ikpagQ7kNvwEVx5Ct&_nc_oc=Adks3CcYmusrNehLiCsYR1ix2RlSxn6gXDnbMTdpfWs8oUYKKxpoAhg7p4zynD4C8kU&_nc_zt=14&_nc_ht=scontent-d...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 2: Create Scripts
...
### Specified Script Names:
...
### Mentor’s Note
...
### Script Setup
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 3: Prepare Scripts
...
### Mentor’s Note

 I personally like the explicit approach as you will know all items that have
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 3: Prepare Scripts
...
### Mentor’s Note
...
been imported from specific APIs, and you can do less typing, which is always nice! ![Image](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452578528_512509781286978_2962179804368749502_n.png?_nc_cat=108&ccb=1-7&_nc_sid=e280be&_nc_ohc=Dw05G6N1QoMQ7kNvwEdcjGi&_nc_oc=AdkuLbqy3T7nkag_Aockl5Xs5G1PxDnCKHdwDFLaA67WlJBamgpwOMOm3_-JoRcchp8&_nc_zt=14&_nc_ht=scontent-dfw5-3.xx&_nc_gid=qAmEIbIl1jtgnLEKkc-HIg&o...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 3: Prepare Scripts
...
### Mentor’s Note
...
 ![Image](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452506810_512509757953647_8787940282338034104_n.png?_nc_cat=102&ccb=1-7&_nc_sid=e280be&_nc_ohc=WYhz1YO2toIQ7kNvwH1wK6e&_nc_oc=AdkP1sPzSI3TeSfvy5KsF_NvWE8ap8mhQHNa9mXSoevdDWFUPgVDQr1_zREoGIzgX9k&_nc_zt=14&_nc_ht=scontent-d...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 3: Prepare Scripts

 To get started delete all the prefilled code from the _Defs file, and adjust the
_Manager to explicitly import Component, rather than * as “hz” importing all. Note: This is a personal preference, please choose the approach that works best
for you.  
### Mentor’s Note
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## What Are JSON Objects?

 JSON objects are powerful variables that can store various types of data. JSON
objects can even nest inside of each other. These may be referred to simply as
objects, variable folders, or more informally “bags of stuff.” This is a simple example storing just two variables for tracking a player’s name
and number of visits:  `const` playerInfo `=` `{` name`:` `‘`playerName`’,` visits`:` `0` `};` In TypeScript it is often necessary to define a type to describe the object, for
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## What Are JSON Objects?
...
instance, in this case we would have:  `type `PlayerInfo` `=` `{`name`:` `string`;` visits`:` number`};` We then need to declare the Type when creating the playerInfo variable:  `const` playerInfo`:` `PlayerInfo` `=` `{` name`:` `‘`playerName`’,` visits`:` `0` `};` Notice that the variable is in camelCase and the type is in PascalCase. This
differentiation shows that the playerInfo is the object variable storing the data.
And, PlayerInfo is the type we are declaring it to be. Next let’s look at a complex example, with nested objects and multiple variable
types. In this example, notice that when the type is larger the variable is
broken onto its own line:  
```
type PlayerInfo = {
name: string,
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## What Are JSON Objects?
...
visits: PlayerVisits,
scores: PlayerScores,
};

type PlayerVisits = {
totalVisits: number,
uniqueDays: number,
totalTimeMins: number,
lastVisitTimeSinceEpochMs: number,
};

type PlayerScores = {
fastestTime: number,
highScore: number,
};

const playerInfo: PlayerInfo = {
name: ‘playerName’,
visits: {
totalVisits: 0,
uniqueDays: 0,
totalTimeMins: 0,
lastVisitTimeSinceEpochMs: 0,
},

scores: {
fastestTime: 0,
highScore: 0,
},
};
```
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 4: Connect Events

 Next, we will connect the CodeBlockEvents for player enter and exit world to
local methods. We have also added a console log to the methods to confirm the
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 4: Connect Events
...
script is working. ![Screenshot 2024-03-12 171631.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452881431_512509817953641_3022961139974047751_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=C2kDgCM2MzIQ7kNvwHJFX8Q&_nc_oc=AdkIMhDwizyKVBE_LkYKw_6glsoiEQZVukIIjvtfNdbMHbAAKfc9dW0PSgks_fQEpdY&_nc_zt=14&_nc_ht=scontent-dfw5-3.xx&_nc_gid=qAmEIbIl...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 4: Connect Events
...
 Ensure that the PlayerVar_Manager script is attached to an object in your world.
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 4: Connect Events
...
In this example, I used a text object: ![Screenshot 2024-03-12 171735.png](https://scontent-dfw5-1.xx.fbcdn.net/v/t39.2365-6/452513283_512509791286977_42569017604569069_n.png?_nc_cat=111&ccb=1-7&_nc_sid=e280be&_nc_ohc=b3gQCt4ABfEQ7kNvwGK9C37&_nc_oc=AdlP9RZB4y8TbXtAl9zKOg9JffIhvbjiH2byWEOpXKIZxXdj5RcfQuZUlc-aJExWTsw&_nc_zt=14&_nc_ht=scontent-dfw5-1.xx...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 4: Connect Events
...
![Screenshot 2024-03-12 171909.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452742345_512509761286980_4350714917524728780_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=FoGBP8oPV40Q7kNvwH_m005&_nc_oc=AdkJn8NawyjCBdCo7NpBcc663q4K03hEXwd9wSaaN01_HBW3B-174s1b_t36rANnpRY&_nc_zt=14&_nc_ht=scontent-dfw5-3.xx&_nc_gid=qAmEIbIl1jtgnLEKkc-HIg&oh=00...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 4: Connect Events
...
![Screenshot 2024-03-12 171909.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452701864_512509787953644_6289865107426242307_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=WdF-i-WdD58Q7kNvwEn1Evo&_nc_oc=AdlysEtYvp_s0ggGua4lQSS6ZWeIYy53Rkb4jcjpMv1NFjtVDAMAvyqCMfCE3o-COEs&_nc_zt=14&_nc_ht=scontent-dfw5-3.xx&_nc_gid=qAmEIbIl1jtgnLEKkc-HIg...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 5: Define Type

 Before we can get and set a JSON Object PPV, we need to define it. Because this
type is stored in a _Defs script, we need to be able to access it from our other
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 5: Define Type
...
script files. To do this we add the word export to the front. ![Screenshot 2024-03-12 181652.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452554819_512509784620311_8209205062022272298_n.png?_nc_cat=104&ccb=1-7&_nc_sid=e280be&_nc_ohc=MNm7lV27KDIQ7kNvwGa23yW&_nc_oc=AdnCqZi83xLiBQszlQuaTH8pTtZbnNCJn3lEjeOmsyZ-FYjeWYS8MKsGxo72lU288CU&_nc_zt=14&_nc_ht=scontent-d...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 5: Define Type
...
 Now that we have exported the type, we can import it into any of our other
scripts by typing “PlayerVar” and clicking “enter” or “return” on our keyboard to
import the type.  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 6: Map PlayerVar

 Now that our _Defs file is setup, we need a place to store all of our player
variable data. We will do this in a _Data script. Create a new script in Meta Horizon named “PlayerVar_Data,” and then we will
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 6: Map PlayerVar
...
delete all of the prefilled code as we did with the _Defs script. ![Screenshot 2024-03-12 181658.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452554819_512509784620311_8209205062022272298_n.png?_nc_cat=104&ccb=1-7&_nc_sid=e280be&_nc_ohc=MNm7lV27KDIQ7kNvwGa23yW&_nc_oc=AdnCqZi83xLiBQszlQuaTH8pTtZbnNCJn3lEjeOmsyZ-FYjeWYS8MKsGxo72lU288CU&_nc_zt=14&_nc_ht=scontent-d...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 6: Map PlayerVar
...
 We will only need to write one line of code, and as we do, VS Code will write
the import lines seen in the screenshot on lines 1 and 2.  `export` `const` allPlayerVarData `=` `new` `Map`<`Player`,` `PlayerVar`>();` Note: You will need to press enter after typing “Player” and “PlayerVar” for these
two types to be imported. If your IDE, in this case VS Code, doesn’t support
automatic importing you may need to write lines 1 and 2.  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## What is a Map?

 A map is a data type that is similar to a list, but does not use indexes.
Instead you can have one of the first type (the key), with the second type “mapped” to
that key. In this example (seen in the image above) we have a player as our key. Because a
player cannot be in the world twice, only unique players can exist in our
world, it makes for a perfect key. Then the data we are mapping to that player is the
PlayerVar type we defined in the _Defs file. Exporting this map as a constant prevents overwriting it with a new map.
Instead, modifications must be made using the map’s set and delete methods, which will
be discussed later in this document. We also export this data, because it is very likely you will need to use it
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## What is a Map?
...
across multiple scripts. Since we will not be setting the PPV until the player
leaves the world, this means that the map will store the player’s JSON Object PPV for
the duration of their stay. In other words it is the source of truth for the
most up-to-date variable values.  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager

 In this step, we will start to write some code.  On the next few pages, we will
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
provide in-depth explanations for each line: ![Image](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452578528_512509781286978_2962179804368749502_n.png?_nc_cat=108&ccb=1-7&_nc_sid=e280be&_nc_ohc=Dw05G6N1QoMQ7kNvwEdcjGi&_nc_oc=AdkuLbqy3T7nkag_Aockl5Xs5G1PxDnCKHdwDFLaA67WlJBamgpwOMOm3_-JoRcchp8&_nc_zt=14&_nc_ht=scontent-dfw5-3.xx&_nc_gid=qAmEIbIl1jtgnLEKkc-HIg&o...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
 At the beginning of the script, you’ll encounter the variables. These variables
are globally scoped variables, which means they are accessible from anywhere
inside this script. These variables are constants; for instance, the
playerVariableVersion should only be updated manually when introducing new variables—a process
detailed later in the document (Step 9). Similarly, the playerVarName remains
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
unchanged as it serves as a reference to the PPV variable. ![Screenshot 2024-03-12 181721.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452893310_512509764620313_8601289411585962013_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=95J44Nnz-EQQ7kNvwFFquh1&_nc_oc=AdnXFWOTw__4tURC-tQ5UMKpL0CZLSQ4SS9wqDmL-HjcMXS5o_0yCYTy9mH0-hUXR00&_nc_zt=14&_nc_ht=scontent-dfw5...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
 In playerEnterWorld we first get the PPV. Notice that it could be null, we
handle this in the initializePlayerVar method (seen at the end of this step). Which
we use to create a newPlayerVar. We have to create a newPlayerVar because the
player may have last played in an older version with less variables stored in the
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
PlayerVar type. ![Screenshot 2024-03-12 181721.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452963336_512509777953645_4263171605963207015_n.png?_nc_cat=102&ccb=1-7&_nc_sid=e280be&_nc_ohc=XJrO7bSPb4MQ7kNvwEJpjmh&_nc_oc=Adl-3SO7N6W2O1JMtpkx9texDjaynV0lQJdUaPTv5_TJOoAXnWKnoETB9lFzt-w24vE&_nc_zt=14&_nc_ht=scontent-dfw5-2.xx&_nc_gid=qAm...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
 Then we update the visits to be visits + 1, using the shorthand visits++. To
make sure this is working we add a console log. The last step is to add the player to the map we created in the previous step.
We do this by using the .set method, which will replace the previous value if it
has already been set. You can use the .has method, if you want to see if the
player has already been mapped. In playerExitWorld we get the playerVar from the map, which if you hover over
the const playerVar will show that it is of type PlayerVar or Undefined. This is
because it is possible that a player has not yet been mapped. We can check for
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
this with if (playerVar) which checks if it is “true,” meaning not undefined , null , false or sort of false (i.e., 0, empty string). We can use an else statement that
calls on console log if it is undefined; this can help locate bugs now and in the
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
future. It is recommended to use checks like this in your code. ![Screenshot 2024-03-12 181721.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452673104_512509774620312_3142404411627905147_n.png?_nc_cat=104&ccb=1-7&_nc_sid=e280be&_nc_ohc=4x1oQc5ViLwQ7kNvwHyUItR&_nc_oc=AdmBn-T7GdKO7iH3KCgAEvNgR0HO3rkrCUKcDsJWEH9P2fDdPCCrEbUdFeIJWUYJxmQ&_nc_zt=14&_nc_ht=sconte...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
 Now that we know playerVar is defined, we can set the player’s JSON Object PPV,
which saves their JSON Object to the world’s persistent storage. At the very end, we delete the player from the map. Outside of our PlayerVar_Manager class, we can create functions. Note that these
are similar to methods, but methods are stored inside classes. In this case, we
are creating a function called initializePlayerVar, which will return a
PlayerVar. This function is important because it allows us to take a potentially
null/undefined value, or partially defined value, and create a new object variable. Please note: There is an error as of the time of writing in Meta Horizon’s API, which says
the variable could be defined or null, but is actually defined or undefined.
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
This distinction caused an error with the code seen at the beginning of this step, below the code is corrected, checking the truthiness of (prevPlayerVar) rather
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
than (prevPlayerVar !== null). ![Image](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452415047_512509744620315_2203337898861099810_n.png?_nc_cat=106&ccb=1-7&_nc_sid=e280be&_nc_ohc=LbE7Bx4BhLEQ7kNvwF6YYkS&_nc_oc=AdktORUNNlNA9nF5B590srvXR5RS8k0mPzbT301dVDzsVmBCVqvjZ6azqfRWNKIVTII&_nc_zt=14&_nc_ht=scontent-dfw5-2.xx&_nc_gid=qAmEIbIl1jtgnLEKkc-HIg&o...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 7: PlayerVar_Manager
...
 The first thing we do in this function is create a brand new object variable
with values we would assign to a first-time visitor. That way if the prevPlayerVar
is not truthy we return those values. Otherwise, we can check that the version
contains values we want to recall, and save them to the new object. Now you can compile your newly saved code and test it. If all goes well, every
time you preview the world, your number of visits will go up by one, and log to
the console!  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 8: Test PlayerVar Size

 Now that we have our JSON Object PPV, we need to make sure we don’t run it over
the 10,000 character limit. To test this we can create an artificial maxed
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 8: Test PlayerVar Size
...
variable and stringify it to see how long it is. ![Screenshot 2024-03-12 184022.png](https://scontent-dfw5-1.xx.fbcdn.net/v/t39.2365-6/452751568_512509754620314_8517786802089207349_n.png?_nc_cat=101&ccb=1-7&_nc_sid=e280be&_nc_ohc=VDJVpH86q74Q7kNvwHnlLyx&_nc_oc=AdltfNfZt-tkN6Uz0Gcm1BaJ-G1dQ5lxgoh9r8_4FdfWxhIShe_FqN1ey8DziVEMfnE&_nc_zt=14&_nc_ht=scontent-dfw5...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 8: Test PlayerVar Size
...
 In our testPlayerVarSize function, we have created a testPlayerVar variable with
larger-than-possible values. We then calculate the length using JSON.stringify,
and the .length property of strings. We then simply log that number to the
console. All that is left, is to call this in the start method. When we are done, we can
delete this line of code from start, and write it in anytime we need to check
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 8: Test PlayerVar Size
...
the max length. ![Screenshot 2024-03-12 184035.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452616143_512509751286981_1414151313288137369_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=K2xCVHjkbM4Q7kNvwGzZsBd&_nc_oc=AdmTe5pKF7uqhequ-bBa3dyjIVplx0r2y7Cehpxm3pcOSNTr0nkBgp3kaZkHu2v_930&_nc_zt=14&_nc_ht=scontent-dfw5-3.xx&_nc_gid=qAmEI...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 9: Add More Variables

 Start by updating the type to include additional variables. In this case we
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 9: Add More Variables
...
added isAFK and afkCount: ![Screenshot 2024-03-19 at 12.18.46 PM.png](https://scontent-dfw5-3.xx.fbcdn.net/v/t39.2365-6/452916228_512509767953646_8032047240862163427_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=YIkYKOa_DAsQ7kNvwENdSfI&_nc_oc=AdmHlne2LCSGycz2qgNdPRSQuoCsybnr-3BD0XDhv7dKTNhVh_Z5nGRDmBnydEdZR1g&_nc_zt=14&_nc_ht=scontent-dfw5-...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 9: Add More Variables
...
 We then add these to the initialize and test size functions: ![Screenshot 2024-03-12 185301.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452742345_512509857953637_3325756538951273658_n.png?_nc_cat=104&ccb=1-7&_nc_sid=e280be&_nc_ohc=bHp6zuNNv6AQ7kNvwGxZUT2&_nc_oc=Admxb9Hau-7-N2pbmeot3Y40MEKTBb3pgx4iugQPqhLESTEO4mehd-ogbOdjxk2OqIw&_nc_zt=14&_nc_ht=scontent-dfw5-2.xx...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 9: Add More Variables
...
![Screenshot 2024-03-12 185200.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452746744_512509741286982_2246072596883689413_n.png?_nc_cat=107&ccb=1-7&_nc_sid=e280be&_nc_ohc=QG2VhCA1jaoQ7kNvwG1Pz6r&_nc_oc=AdkH2yPCPPP27ioZ78gNOpPpZ67FJwe0_r8CROF05sSs-HoJ4MQvj_9HphdSnSA9PFI&_nc_zt=14&_nc_ht=scontent-dfw5-2.xx&_nc_gid=qAmEIbIl...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 9: Add More Variables
...
 We also need to update the version number from 1 to 2: ![Screenshot 2024-03-12 185053.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452701864_512509737953649_3962852608460184155_n.png?_nc_cat=102&ccb=1-7&_nc_sid=e280be&_nc_ohc=-2MzCe_X7c8Q7kNvwHvAALv&_nc_oc=AdkaHwubFPGHvM7NkAbzUKtKWWbwPjyq-0f3977ooOllKZJxBobGNk01JpTcBtOlAhw&_nc_zt=14&_nc_ht=sc...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 9: Add More Variables
...
 Then we can use this new version number to get the afkCount for players who have
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 9: Add More Variables
...
visited our world since the variable was added: ![Screenshot 2024-03-12 185249.png](https://scontent-dfw5-1.xx.fbcdn.net/v/t39.2365-6/452652242_512509854620304_1398487090111015541_n.png?_nc_cat=110&ccb=1-7&_nc_sid=e280be&_nc_ohc=3GWL3V6s7QcQ7kNvwGihn4Z&_nc_oc=AdndBznrAiOOEGos8MBEjQoTSGhAYEgvU9v5XwOI6icpRI07Tdxstnh-BExqJ99Rbxo&_nc_zt=14&_nc_ht=scontent-dfw5-1.xx&_nc_g...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 10: Use the Variables
...
### Mentor’s Note

 When a player arrives to your world, I have experienced in build mode this
causing the AFK events to fire before the player enter world event does, so you will
need to make sure the map has the player before setting the value, or check the
truthiness as we did above.  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 10: Use the Variables

 To get started using our new afkCount variable, we will connect the
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 10: Use the Variables
...
CodeBlockEvents for entering AFK to our local method: ![Screenshot 2024-03-12 185526.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452578037_512509851286971_2231847787475568309_n.png?_nc_cat=107&ccb=1-7&_nc_sid=e280be&_nc_ohc=6NcgF2TkjwkQ7kNvwEWH4NZ&_nc_oc=AdkGcD1ozBVMhhgUSaBsVtWr2mhOorU9tzrc53KWl7eRY_ZlJ6YElvpAbx4Jn5PRFkM&_nc_zt=14&_nc_ht=scontent-dfw5-2...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 10: Use the Variables
...
 ![Screenshot 2024-03-12 185514.png](https://scontent-dfw5-2.xx.fbcdn.net/v/t39.2365-6/452909009_512509837953639_6530190211756898574_n.png?_nc_cat=102&ccb=1-7&_nc_sid=e280be&_nc_ohc=moqZcyghCPwQ7kNvwFLqkGc&_nc_oc=AdkWpPg-hA_3RSfg2qr7d7_GOS8pzn_TWSf7VI6gMg4rTgCf7bLKBrsjyg-FMfuWduE&_nc_zt=14&_nc_ht=scontent-dfw5-2.xx&_nc_gid=qAmEIbIl...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Step 10: Use the Variables
...
 Then we can get the playerVar and check the truthiness, updating the count to be
+1. For extra credit try adding the playerExitAFK method and updating the
boolean we added to the playerVar. Setting it to true when AFK, and false when they
return from AFK.  
### Mentor’s Note
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Further Assistance

 Thank you for following along! This guide aims to unlock your TypeScript super
powers, and add awesome new features to your worlds! If you need additional support feel free to book me (Vidyuu / Laex05) for a 1:1
lesson. Consider trying the extra credit tasks below to solidify your learning and take
it to the next level!  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Next Steps
...
### Novice

 Track player visits and time spent in your world.  
### Intermediate

 Track unique daily visits a player has had to your world.  
### Advanced

 Build a streak system to track how many days in a row each player has visited
your world.  
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Next Steps
...
### Bonus

 Give the player a reward for visiting your world once per day, and or when they
reach time spent thresholds.    ![Nav Logo](https://static.xx.fbcdn.net/rsrc.php/yE/r/3SoBlk8EqOQ.svg)


[Facebook](https://www.facebook.com/MetaHorizon/)
[Threads](https://www.threads.com/@metahorizon)
[X](https://x.com/MetaHorizon)
[Instagram](https://www.instagram.com/metahorizon/)
[YouTube](https://www.youtube.com/@MetaQuestVR)

 Learn
[Documentation](https://developers.meta.com/horizon-worlds/learn/documentation/)
[Blog](https://developers.meta.com/horizon/blog/)
[Forum](https://communityforums.atmeta.com/t5/Creator-Forum/ct-p/Meta_Horizon_Creator_Forums)

 Programs
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Next Steps
...
### Bonus
...
[Meta Horizon Creator Program](https://developers.meta.com/horizon-worlds/programs/)

 My Creations
[My Worlds](https://horizon.meta.com/creator/worlds_all/?utm_source=horizon_worlds_creator)
[My Assets](https://horizon.meta.com/creator/assets/?utm_source=horizon_worlds_creator)
[Performance](https://horizon.meta.com/creator/performance/traces/?utm_source=horizon_worlds_creator)

 Privacy & Legal
[Privacy Policy](https://www.meta.com/legal/privacy-policy/)
[Legal](https://www.meta.com/legal/supplemental-terms-of-service/)

 © 2025 Meta
...
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
## Additional Links
- [Meta home](https://developers.meta.com/horizon-worlds/)
- [Login](https://developers.meta.com/login/?redirect_uri=https%3A%2F%2Fdevelopers.meta.com%2Fhorizon-worlds%2Flearn%2Fdocumentation%2Fmhcp-program%2Fcommunity-tutorials%2Fmeta-horizon-typescript-api-20-json-ppvs--versioning-%2F)
...
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning

 Author: Laex05  
## Introduction
...
## Step 1: Create a JSON PPV
...
## Step 2: Create Scripts
...
## Step 3: Prepare Scripts
...
## What Are JSON Objects?
...
## Step 4: Connect Events
...
## Step 5: Define Type
...
## Step 6: Map PlayerVar
...
## What is a Map?
...
## Step 7: PlayerVar_Manager
...
## Step 8: Test PlayerVar Size
...
## Step 9: Add More Variables
...
## Step 10: Use the Variables
...
## Further Assistance
...
## Next Steps
...
## Additional Links
...
      Learn
# Meta Horizon TypeScript API 2.0: JSON PPVs & Versioning
...
